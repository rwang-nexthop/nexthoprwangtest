# NextHop Lab - T2 Topology with SONiC DUTs and Nokia SR Linux
# This topology demonstrates a T2 architecture with:
# - 2 SONiC DUTs (linecards)
# - 4 Nokia SR Linux nodes (2 T3 and 2 T1)
# - BGP routing between all nodes

name: nexthop-lab

topology:
  kinds:
    nokia_srlinux:
      image: ghcr.io/nokia/srlinux
      kind: nokia_srlinux
    sonic-vs:
      image: container-registry.sw.internal.nexthop.ai/clab-sonic:10368
      kind: sonic-vs

  nodes:
    # SONiC DUTs (Linecards)
    dut0:
      kind: sonic-vs
      mgmt-ipv4: 172.20.20.10
      startup-config: dut0-startup.conf

    dut1:
      kind: sonic-vs
      mgmt-ipv4: 172.20.20.11
      startup-config: dut1-startup.conf

    # Nokia SR Linux T3 Nodes (Core)
    srl01t3:
      kind: nokia_srlinux
      mgmt-ipv4: 172.20.20.20
      startup-config: srl01t3-startup.cfg

    srl03t3:
      kind: nokia_srlinux
      mgmt-ipv4: 172.20.20.21
      startup-config: srl03t3-startup.cfg

    # Nokia SR Linux T1 Nodes (Leaf)
    srl01t1:
      kind: nokia_srlinux
      mgmt-ipv4: 172.20.20.22
      startup-config: srl01t1-startup.cfg

    srl03t1:
      kind: nokia_srlinux
      mgmt-ipv4: 172.20.20.23
      startup-config: srl03t1-startup.cfg

  links:
    # DUT0 to Nokia SR Linux T3 connections
    # SRL01T3 LAG (e1-1/e1-2) to DUT0 (Ethernet0 and Ethernet1)
    - endpoints: ["dut0:Ethernet0", "srl01t3:e1-1"]
    - endpoints: ["dut0:Ethernet1", "srl01t3:e1-2"]

    # SRL03T3 single port to DUT0
    - endpoints: ["dut0:Ethernet2", "srl03t3:e1-1"]

    # DUT1 to Nokia SR Linux T1 connections
    # SRL01T1 LAG (e1-1/e1-2) to DUT1 (Ethernet0 and Ethernet1)
    - endpoints: ["dut1:Ethernet0", "srl01t1:e1-1"]
    - endpoints: ["dut1:Ethernet1", "srl01t1:e1-2"]

    # SRL03T1 single port to DUT1
    - endpoints: ["dut1:Ethernet2", "srl03t1:e1-1"]

    # Inter-DUT connection for chassis communication
    - endpoints: ["dut0:Ethernet3", "dut1:Ethernet3"]

